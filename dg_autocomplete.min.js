/*! dg_autocomplete 2016-12-06 */
var dg_autocomplete=new dg.Module;dg.modules.dg_autocomplete=dg_autocomplete,dg_autocomplete._typingTimer=null,dg_autocomplete._doneTypingInterval=175,dg.autocompletePrepTextInput=function(a){var b=a._text_input?a._text_input:{};return dg.setRenderElementDefaults(b),b._attributes.type="text",b._attributes.id||(b._attributes.id="autocomplete-"+jDrupal.userPassword()),!b._title&&a._title&&a._title_placeholder&&(b._attributes.placeholder=""+a._title),b},dg.autocompletePrepListItem=function(a,b,c,d){return{_theme:"list_item",_i:b,_total:a.length,_text:d,_attributes:{value:c}}},dg.autocompleteAddClassToWidget=function(a,b){a._attributes||(a._attributes={}),a._attributes.class||(a._attributes.class=[]),"string"==typeof a._attributes.class&&(a._attributes.class=[a._attributes.class]),jDrupal.isArray(a._attributes.class)&&!jDrupal.inArray(b,a._attributes.class)&&a._attributes.class.push(b)},dg.autocompleteAttachPostRender=function(a,b,c,d){a._postRender||(a._postRender=[]),a._postRender.push(function(){for(var a=document.getElementById(b._attributes.id),e='[autocomplete="'+c.id+'"] ul.autocomplete li',f=document.querySelectorAll(e),g=0;g<f.length;g++)f[g].setAttribute("delta",g),f[g].onclick=function(){a.setAttribute("value",this.getAttribute("value")),b._clicker(a,c,d,this)}})},dg_autocomplete.run=function(a,b){""!=b.val&&a._fetcher(b).then(function(c){var d=a._handler(b,c);if(d.results){var e=d.results;dg.autocompleteAddClassToWidget(e,"autocomplete"),dg.autocompleteAttachPostRender(e,a,b,c),document.querySelectorAll('[autocomplete="'+b.id+'"]')[0].innerHTML=dg.render(d),dg.runPostRenders()}})},dg.autocompleteVerify=function(a){var b=a._attributes.id;return a._fetcher?a._handler?!!a._clicker||(console.log("dg.theme_autocomplete - no _clicker provided for element: "+b),!1):(console.log("dg.theme_autocomplete - no _handler provided for element: "+b),!1):(console.log("dg.theme_autocomplete - no _fetcher provided for element: "+b),!1)},dg.theme_autocomplete=function(a){a._attributes.type="hidden";var b=dg.autocompletePrepTextInput(a);if(dg.autocompleteVerify(a)){var c=b._attributes.id;return dg.render({_markup:'<div class="autocomplete-wrapper"><input '+dg.attributes(a._attributes)+"/><input "+dg.attributes(b._attributes)+'/><div autocomplete="'+c+'"></div></div>',_postRender:[function(){document.getElementById(c).addEventListener("keyup",function(){clearTimeout(dg_autocomplete._typingTimer);var b=this;dg_autocomplete._typingTimer=setTimeout(function(){dg_autocomplete.run(a,b)},dg_autocomplete._doneTypingInterval)})}]})}};